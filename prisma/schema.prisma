generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Quiz{
  id   String  @id @default(uuid())
  title String @unique
  startAt DateTime  @default(now())
  endAt DateTime  @default(now())
  // status String  @default("Draft") // Draft, Publish
  questions Question[]
  teams Team[]
  // activeIndex Int @default(1)
}

model AttackLogs{
  id    String  @id @default(uuid())
  createdAt          DateTime  @default(now()) 
  team_no String
  script_name String
  job_number Int 
}

model Team {
  id   String  @id @default(uuid())
  name String  @unique
  // api_key String? 
  // team_number Int? 
  quiz Quiz? @relation(fields: [quizId], references: [id])
  quizId String?
  answers Answer[]
  users  User[]
}

model User {
  id   String  @id @default(uuid())
  email String  @unique
  name  String?
  role  String?  @default("user")
  password  String
  answers Answer[]
  team Team? @relation(fields: [teamId], references: [id])
  teamId String?
  country String? @default("")
  
}

model AttackScript{
  id    String  @id @default(uuid())
  name String 
  script_category String
  desc String @default("")
  addedAt DateTime  @default(now())
}

model Scenario{
  id    String    @id @default(uuid())
  name String 
  addedAt DateTime  @default(now())
  questions Question[]
  status String  @default("In Progress")    
  category String @default("Security Operations") 
  desc   String @default("")
  difficulty String @default("Easy")
  tags String @default("")
  files File[]
}



model File {
  id       String      @id @default(uuid())
  filename String @default("")
  filepath String @default("")  // This could be a relative/absolute path or a URL
  password String @default("")
  scenario Scenario? @relation(fields: [scenarioId], references: [id])
  scenarioId String?
}


model Question{
  id   String  @id @default(uuid())
  title String @default("")
  Description String @default("")
  points Int @default(50) 
  // option_1 String @default("")
  // option_2 String @default("")
  // option_3 String @default("")
  // option_4 String @default("")
  // option_5 String @default("")
  // option_6 String @default("")
  original_answer String @default("")
  // question_index Int @default(1)
  // type String @default("1")
  // status String  @default("Publish")    // Draft, Publish
  quiz Quiz? @relation(fields: [quizId], references: [id])
  quizId String?
  answers Answer[]
  scenario Scenario? @relation(fields: [scenarioId], references: [id])
  scenarioId String?
  
}



model Answer{
  id    String  @id @default(uuid())
  submitAnswer String @default("")
  obtainedPoints Int @default(0)
  submissionStatus Boolean @default(false)
  submittedAt DateTime  @default(now())
  // checkStatus Boolean @default(false)
  question Question? @relation(fields: [questionId], references: [id])
  questionId String?
  team Team? @relation(fields: [teamId], references: [id])
  teamId String?
  user User? @relation(fields: [userId], references: [id])
  userId String?
}


  // model Logs {
  //   id                  String      @id @default(uuid())
  //   action_by           String      @default("")
  //   action_related_to   String      @default("")
  //   message             String      @default("")
  //   level               String      @default("info")
  //   timestamp           DateTime    @default(now())
  // }